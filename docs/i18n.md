# Sistema de Internacionalizaci贸n (i18n) - Gu铆a de Usuario

## Informaci贸n del Proyecto
- **Aplicaci贸n**: LuxSequencer - Generador de patrones visuales en tiempo real
- **Framework**: React 19 + Vite + Zustand + TypeScript
- **Sistema i18n**: Rosetta (~2KB)
- **Idiomas soportados**: English (en), Espa帽ol (es)

## 1. Cambiar Idioma de la Aplicaci贸n

### Selector de Idioma
En la aplicaci贸n hay un selector de idioma que permite cambiar entre ingl茅s y espa帽ol. Se encuentra en la interfaz principal y el cambio es inmediato.

### Persistencia
El idioma seleccionado se guarda autom谩ticamente y se mantiene al recargar la aplicaci贸n.

## 2. A帽adir Nuevas Cadenas de Traducci贸n

### 2.1. Agregar a Translations

Editar el archivo `src/i18n/translations.ts`:

```typescript
export const translations: Record<LocaleCode, TranslationKeys> = {
  en: {
    // Existing translations...
    'your.new.key': 'Your English Text',
  },
  
  es: {
    // Existing translations...
    'your.new.key': 'Tu Texto en Espa帽ol',
  }
}
```

### 2.2. Actualizar Types

Agregar la nueva clave en `src/i18n/types.ts`:

```typescript
export interface TranslationKeys {
  // Existing keys...
  'your.new.key': string
}
```

### 2.3. Convenciones de Nomenclatura

Las claves siguen un patr贸n de puntos para organizarse por secciones:

- `common.*` - Textos comunes (Save, Cancel, etc.)
- `header.*` - Elementos del header
- `sequencer.*` - Controles del secuenciador
- `controls.*` - Etiquetas de controles
- `midi.*` - Funcionalidades MIDI
- `project.*` - Gesti贸n de proyectos
- `patterns.*` - Gesti贸n de patrones
- `renderer.*` - Nombres de renderizadores
- `section.*` - T铆tulos de secciones
- `viewport.*` - Configuraciones de viewport
- `debug.*` - Consola de debug
- `ui.*` - Acciones de UI
- `sequence.*` - Gesti贸n de secuencias
- `shape.*` - Formas y valores
- `error.*` - Mensajes de error

## 3. Usar Traducciones en Componentes

### 3.1. Hook useTranslation (Recomendado)

```typescript
import { useTranslation } from '../i18n/hooks/useTranslation'

const MyComponent: React.FC = () => {
  const { t } = useTranslation()
  
  return (
    <div>
      <button>{t('common.save')}</button>
      <span>{t('sequencer.patterns')}</span>
    </div>
  )
}
```

### 3.2. Funci贸n t directa

Para uso en archivos que no son componentes React (schemas, utilitarios):

```typescript
import { t } from '../i18n'

const mySchema = {
  label: t('controls.scaleSize'),
  placeholder: t('common.loading')
}
```

### 3.3. Traducciones con Par谩metros

```typescript
// En translations.ts
'sequencer.bpm': 'BPM: {{value}}'
'debug.animations': 'Active Animations: {{count}}'

// En componente
const { t } = useTranslation()

return (
  <div>
    <span>{t('sequencer.bpm', { value: 120 })}</span>
    <span>{t('debug.animations', { count: 5 })}</span>
  </div>
)
```

### 3.4. Traducciones con Interpolaci贸n Compleja

```typescript
// Para mensajes de confirmaci贸n
'sequence.confirmDelete': 'Delete sequence "{{name}}"? This action cannot be undone.'

// Uso
const confirmMessage = t('sequence.confirmDelete', { name: 'My Sequence' })
// Resultado: 'Delete sequence "My Sequence"? This action cannot be undone.'
```

## 4. Organizaci贸n de Traducciones Existentes

### Common (Textos Comunes)
- `common.loading`, `common.error`, `common.success`
- `common.cancel`, `common.save`, `common.delete`, `common.close`
- `common.instant`

### Header
- `header.renderer`, `header.viewport`, `header.midi`
- `header.fullscreen`, `header.settings`, `header.sequencer`

### Sequencer
- `sequencer.play`, `sequencer.stop`
- `sequencer.bpm`, `sequencer.steps`, `sequencer.patterns`
- `sequencer.addPattern`, `sequencer.saveCurrentPattern`
- `sequencer.loadPattern`, `sequencer.deletePattern`
- `sequencer.interpolationSpeed`, `sequencer.propertySequencer`

### Controls
- `controls.scaleSize`, `controls.animationSpeed`
- `controls.borderSize`, `controls.borderColor`
- `controls.scaleGradient`, `controls.backgroundGradient`
- `controls.rotationSpeed`, `controls.opacity`, `controls.blendMode`
- `controls.hexRadius`, `controls.concentricLayers`
- `controls.horizontalSpacing`, `controls.verticalSpacing`
- `controls.horizontalOffset`, `controls.shapeForm`
- `controls.animationDirection`

### MIDI
- `midi.learn`, `midi.learning`, `midi.mapped`
- `midi.console`, `midi.connectDevice`, `midi.noDevices`
- `midi.clearMappings`, `midi.configuration`
- `midi.connectionError`, `midi.retry`
- `midi.inputDevice`, `midi.notConnected`, `midi.connect`
- `midi.waiting`

### Project
- `project.new`, `project.load`, `project.save`
- `project.export`, `project.import`, `project.name`
- `project.defaultName`, `project.globalConfiguration`
- `project.dataManagement`, `project.dataManagementDescription`
- `project.renderEngine`, `project.renderEngineDescription`

### Patterns
- `patterns.title`, `patterns.saveAsNew`, `patterns.overwrite`
- `patterns.overwriteTooltip`, `patterns.overwriteSelectedTooltip`
- `patterns.savedMemories`, `patterns.noPatterns`
- `patterns.assignMidi`, `patterns.clearMidi`

### Renderers
- `renderer.webgl`, `renderer.concentric`

### Sections
- `section.scale`, `section.animation`, `section.appearance`
- `section.background`, `section.border`, `section.concentric`

### Viewport
- `viewport.default`, `viewport.desktop`, `viewport.mobile`

### Debug
- `debug.overlay`, `debug.fps`, `debug.ticks`
- `debug.step`, `debug.animations`, `debug.export`
- `debug.openConsole`, `debug.console`, `debug.metrics`
- `debug.rafCalls`, `debug.settingsUpdates`, `debug.sequencerTicks`
- `debug.currentStep`, `debug.animationActive`, `debug.activeAnimations`
- `debug.interpolationSpeed`, `debug.settingsHash`, `debug.steps`
- `debug.clearLogs`, `debug.exportData`, `debug.eventLog`, `debug.noEvents`

### UI Actions
- `ui.clear`, `ui.save`, `ui.cancel`, `ui.duplicate`
- `ui.resetToDefault`, `ui.enterFullscreen`, `ui.exitFullscreen`
- `ui.openControls`, `ui.closeControls`
- `ui.openSequencer`, `ui.closeSequencer`
- `ui.openMidiConsole`, `ui.clearConsole`, `ui.closeConsole`

### Sequences
- `sequence.label`, `sequence.new`, `sequence.duplicate`
- `sequence.delete`, `sequence.cantDeleteLast`
- `sequence.newName`, `sequence.confirmDelete`

### Shapes
- `shape.circle`, `shape.diamond`, `shape.star`
- `shape.circleToDiamond`, `shape.diamondToStar`, `shape.stopped`

### Errors
- `error.loadProject`, `error.saveProject`
- `error.midiAccess`, `error.invalidProject`
- `error.resetConfirmation`

## 5. Patrones de Uso

### 5.1. Botones de Acci贸n
```typescript
<button onClick={handleSave}>
  {t('common.save')}
</button>
```

### 5.2. Labels de Controles
```typescript
<label>{t('controls.scaleSize')}</label>
```

### 5.3. T铆tulos de Secciones
```typescript
<h3>{t('section.animation')}</h3>
```

### 5.4. Mensajes con Variables
```typescript
const message = t('patterns.assignMidi', { name: patternName })
```

### 5.5. Tooltips y Aria Labels
```typescript
<button 
  title={t('ui.resetToDefault')}
  aria-label={t('ui.closeConsole')}
>
  <Icon />
</button>
```

## 6. Agregar Soporte para Nuevo Idioma

### 6.1. Actualizar LocaleCode
En `src/i18n/types.ts`:
```typescript
export type LocaleCode = 'en' | 'es' | 'fr' // Agregar nuevo idioma
```

### 6.2. Agregar Traducciones
En `src/i18n/translations.ts`:
```typescript
export const translations: Record<LocaleCode, TranslationKeys> = {
  en: { /* traducciones ingl茅s */ },
  es: { /* traducciones espa帽ol */ },
  fr: { /* NUEVAS traducciones franc茅s */ }
}
```

### 6.3. Actualizar Selector de Idioma
En `src/components/i18n/LanguageSelector.tsx`:
```typescript
<option value="fr"> Fran莽ais</option>
```

## 7. Best Practices

### 7.1. Nomenclatura de Claves
- Usar puntos para jerarqu铆a: `section.subsection.item`
- Nombres descriptivos: `midi.connectDevice` en lugar de `midi.connect`
- Agrupar por funcionalidad, no por ubicaci贸n en UI

### 7.2. Textos con Par谩metros
- Usar sintaxis `{{parameter}}` para interpolaci贸n
- Nombres de par谩metros descriptivos: `{{count}}` en lugar de `{{n}}`

### 7.3. Fallbacks
- El sistema muestra la clave como fallback si falta una traducci贸n
- En desarrollo se muestra advertencia en consola para claves faltantes

### 7.4. Performance
- Las traducciones se cargan una vez al inicio
- Los lookups son instant谩neos (O(1))
- No hay impacto en FPS durante uso normal
  'section.animation': string
  'section.appearance': string
  'section.background': string
  'section.border': string
  'section.concentric': string
  
  // Viewport
  'viewport.default': string
  'viewport.desktop': string
  'viewport.mobile': string
  
  // Debug
  'debug.overlay': string
  'debug.fps': string
  'debug.ticks': string
  'debug.step': string
  'debug.animations': string
  'debug.export': string
  
  // Validation/Errors
  'error.loadProject': string
  'error.saveProject': string
  'error.midiAccess': string
  'error.invalidProject': string
}

export type LocaleCode = 'en' | 'es'

export interface TranslationParams {
  [key: string]: string | number
}
```

### 3.2. `src/i18n/translations.ts`

```typescript
import type { TranslationKeys, LocaleCode } from './types'

export const translations: Record<LocaleCode, TranslationKeys> = {
  en: {
    // Common
    'common.loading': 'Loading...',
    'common.error': 'Error',
    'common.success': 'Success',
    'common.cancel': 'Cancel',
    'common.save': 'Save',
    'common.delete': 'Delete',
    'common.close': 'Close',
    
    // Header
    'header.renderer': 'Renderer',
    'header.viewport': 'Viewport',
    'header.midi': 'MIDI Console',
    'header.fullscreen': 'Fullscreen',
    'header.settings': 'Settings',
    'header.sequencer': 'Sequencer',
    
    // Sequencer
    'sequencer.play': 'Play',
    'sequencer.stop': 'Stop',
    'sequencer.bpm': 'BPM: {{value}}',
    'sequencer.steps': 'Steps: {{count}}',
    'sequencer.patterns': 'Patterns',
    'sequencer.addPattern': 'Add Pattern',
    'sequencer.saveCurrentPattern': 'Save Current Pattern',
    'sequencer.loadPattern': 'Load Pattern',
    'sequencer.deletePattern': 'Delete Pattern',
    'sequencer.interpolationSpeed': 'Interpolation Speed',
    'sequencer.propertySequencer': 'Property Sequencer',
    'sequencer.addTrack': 'Add Track',
    
    // Controls
    'controls.scaleSize': 'Scale Size',
    'controls.animationSpeed': 'Animation Speed',
    'controls.borderSize': 'Border Size',
    'controls.borderColor': 'Border Color',
    'controls.scaleGradient': 'Scale Gradient',
    'controls.backgroundGradient': 'Background Gradient',
    'controls.rotationSpeed': 'Rotation Speed',
    'controls.opacity': 'Opacity',
    'controls.blendMode': 'Blend Mode',
    'controls.hexRadius': 'Hexagon Radius',
    'controls.concentricLayers': 'Concentric Layers',
    
    // MIDI
    'midi.learn': 'MIDI Learn',
    'midi.learning': 'Learning...',
    'midi.mapped': 'Mapped to CC{{cc}}',
    'midi.console': 'MIDI Console',
    'midi.connectDevice': 'Connect MIDI Device',
    'midi.noDevices': 'No MIDI devices found',
    'midi.clearMappings': 'Clear All Mappings',
    
    // Project
    'project.new': 'New Project',
    'project.load': 'Load Project',
    'project.save': 'Save Project',
    'project.export': 'Export Project',
    'project.import': 'Import Project',
    'project.name': 'Project Name',
    'project.defaultName': 'LuxSequencer Project',
    
    // Renderers
    'renderer.webgl': 'WebGL Scale',
    'renderer.concentric': 'Concentric Hexagons',
    
    // Sections
    'section.scale': 'Scale Settings',
    'section.animation': 'Animation',
    'section.appearance': 'Appearance',
    'section.background': 'Background',
    'section.border': 'Border',
    'section.concentric': 'Concentric Settings',
    
    // Viewport
    'viewport.default': 'Default',
    'viewport.desktop': 'Desktop (1920x1080)',
    'viewport.mobile': 'Mobile (390x844)',
    
    // Debug
    'debug.overlay': 'Debug Overlay',
    'debug.fps': 'FPS: {{value}}',
    'debug.ticks': 'Ticks: {{count}}',
    'debug.step': 'Step: {{current}}/{{total}}',
    'debug.animations': 'Active Animations: {{count}}',
    'debug.export': 'Export Debug Data',
    
    // Validation/Errors
    'error.loadProject': 'Failed to load project',
    'error.saveProject': 'Failed to save project',
    'error.midiAccess': 'MIDI access denied',
    'error.invalidProject': 'Invalid project format'
  },
  
  es: {
    // Common
    'common.loading': 'Cargando...',
    'common.error': 'Error',
    'common.success': 'xito',
    'common.cancel': 'Cancelar',
    'common.save': 'Guardar',
    'common.delete': 'Eliminar',
    'common.close': 'Cerrar',
    
    // Header
    'header.renderer': 'Renderizador',
    'header.viewport': 'Vista',
    'header.midi': 'Consola MIDI',
    'header.fullscreen': 'Pantalla Completa',
    'header.settings': 'Configuraci贸n',
    'header.sequencer': 'Secuenciador',
    
    // Sequencer
    'sequencer.play': 'Reproducir',
    'sequencer.stop': 'Parar',
    'sequencer.bpm': 'BPM: {{value}}',
    'sequencer.steps': 'Pasos: {{count}}',
    'sequencer.patterns': 'Patrones',
    'sequencer.addPattern': 'A帽adir Patr贸n',
    'sequencer.saveCurrentPattern': 'Guardar Patr贸n Actual',
    'sequencer.loadPattern': 'Cargar Patr贸n',
    'sequencer.deletePattern': 'Eliminar Patr贸n',
    'sequencer.interpolationSpeed': 'Velocidad de Interpolaci贸n',
    'sequencer.propertySequencer': 'Secuenciador de Propiedades',
    'sequencer.addTrack': 'A帽adir Pista',
    
    // Controls
    'controls.scaleSize': 'Tama帽o de Escala',
    'controls.animationSpeed': 'Velocidad de Animaci贸n',
    'controls.borderSize': 'Tama帽o del Borde',
    'controls.borderColor': 'Color del Borde',
    'controls.scaleGradient': 'Gradiente de Escala',
    'controls.backgroundGradient': 'Gradiente de Fondo',
    'controls.rotationSpeed': 'Velocidad de Rotaci贸n',
    'controls.opacity': 'Opacidad',
    'controls.blendMode': 'Modo de Mezcla',
    'controls.hexRadius': 'Radio del Hex谩gono',
    'controls.concentricLayers': 'Capas Conc茅ntricas',
    
    // MIDI
    'midi.learn': 'Aprender MIDI',
    'midi.learning': 'Aprendiendo...',
    'midi.mapped': 'Asignado a CC{{cc}}',
    'midi.console': 'Consola MIDI',
    'midi.connectDevice': 'Conectar Dispositivo MIDI',
    'midi.noDevices': 'No se encontraron dispositivos MIDI',
    'midi.clearMappings': 'Limpiar Todas las Asignaciones',
    
    // Project
    'project.new': 'Nuevo Proyecto',
    'project.load': 'Cargar Proyecto',
    'project.save': 'Guardar Proyecto',
    'project.export': 'Exportar Proyecto',
    'project.import': 'Importar Proyecto',
    'project.name': 'Nombre del Proyecto',
    'project.defaultName': 'Proyecto LuxSequencer',
    
    // Renderers
    'renderer.webgl': 'Escala WebGL',
    'renderer.concentric': 'Hex谩gonos Conc茅ntricos',
    
    // Sections
    'section.scale': 'Configuraci贸n de Escama',
    'section.animation': 'Color de Escamas',
    'section.appearance': 'Apariencia',
    'section.background': 'Fondo',
    'section.border': 'Borde',
    'section.concentric': 'Configuraci贸n Conc茅ntrica',
    
    // Viewport
    'viewport.default': 'Predeterminado',
    'viewport.desktop': 'Escritorio (1920x1080)',
    'viewport.mobile': 'M贸vil (390x844)',
    
    // Debug
    'debug.overlay': 'Overlay de Debug',
    'debug.fps': 'FPS: {{value}}',
    'debug.ticks': 'Ticks: {{count}}',
    'debug.step': 'Paso: {{current}}/{{total}}',
    'debug.animations': 'Animaciones Activas: {{count}}',
    'debug.export': 'Exportar Datos de Debug',
    
    // Validation/Errors
    'error.loadProject': 'Error al cargar proyecto',
    'error.saveProject': 'Error al guardar proyecto',
    'error.midiAccess': 'Acceso MIDI denegado',
    'error.invalidProject': 'Formato de proyecto inv谩lido'
  }
}
```

### 3.3. `src/i18n/index.ts`

```typescript
import { rosetta } from 'rosetta'
import { translations } from './translations'
import type { TranslationKeys, LocaleCode, TranslationParams } from './types'

// Crear instancia de rosetta con todas las traducciones
const r = rosetta<TranslationKeys>(translations)

// Detectar idioma inicial del navegador
const getBrowserLocale = (): LocaleCode => {
  const browserLang = navigator.language.split('-')[0]
  return (['en', 'es'] as LocaleCode[]).includes(browserLang as LocaleCode) 
    ? (browserLang as LocaleCode) 
    : 'en'
}

// Configurar idioma inicial
r.locale(getBrowserLocale())

// Exportar funciones principales
export const t = (key: keyof TranslationKeys, params?: TranslationParams): string => {
  return r.t(key, params) || key
}

export const setLocale = (locale: LocaleCode): void => {
  r.locale(locale)
}

export const getCurrentLocale = (): LocaleCode => {
  return r.locale() as LocaleCode
}

export const getAvailableLocales = (): LocaleCode[] => {
  return ['en', 'es']
}

export { type TranslationKeys, type LocaleCode, type TranslationParams }
```

### 3.4. `src/i18n/hooks/useTranslation.ts`

```typescript
import { useState, useCallback } from 'react'
import { t, setLocale, getCurrentLocale, getAvailableLocales } from '../index'
import type { TranslationKeys, LocaleCode, TranslationParams } from '../types'

export const useTranslation = () => {
  const [currentLocale, setCurrentLocale] = useState<LocaleCode>(getCurrentLocale())

  const translate = useCallback((key: keyof TranslationKeys, params?: TranslationParams): string => {
    return t(key, params)
  }, [])

  const changeLocale = useCallback((locale: LocaleCode) => {
    setLocale(locale)
    setCurrentLocale(locale)
  }, [])

  return {
    t: translate,
    locale: currentLocale,
    setLocale: changeLocale,
    availableLocales: getAvailableLocales()
  }
}
```

## 4. Integraci贸n con Zustand Store

### 4.1. Crear slice de i18n: `src/store/slices/i18n.slice.ts`

```typescript
import type { StateCreator } from 'zustand'
import { setLocale as setRosettaLocale, getCurrentLocale } from '../../i18n'
import type { LocaleCode } from '../../i18n/types'

export interface I18nSlice {
  // State
  locale: LocaleCode
  
  // Actions
  setLocale: (locale: LocaleCode) => void
}

export const createI18nSlice: StateCreator<
  I18nSlice,
  [],
  [],
  I18nSlice
> = (set) => ({
  // Initial state
  locale: getCurrentLocale(),
  
  // Actions
  setLocale: (locale: LocaleCode) => {
    setRosettaLocale(locale)
    set({ locale })
    
    // Persistir en localStorage
    localStorage.setItem('luxsequencer:locale', locale)
  }
})
```

### 4.2. Integrar en store principal: `src/store/index.ts`

Agregar el slice de i18n al store principal:

```typescript
// A帽adir import
import { createI18nSlice, type I18nSlice } from './slices/i18n.slice'

// Agregar a la interfaz principal
interface TextureStore extends 
  ProjectSlice,
  SettingsSlice,
  UISlice,
  SequencerSlice,
  MidiSlice,
  AnimationSlice,
  RecordingSlice,
  I18nSlice {} // <- A帽adir esta l铆nea

// Agregar al store
export const useTextureStore = create<TextureStore>()(
  subscribeWithSelector(
    immer((...a) => ({
      ...createProjectSlice(...a),
      ...createSettingsSlice(...a),
      ...createUISlice(...a),
      ...createSequencerSlice(...a),
      ...createMidiSlice(...a),
      ...createAnimationSlice(...a),
      ...createRecordingSlice(...a),
      ...createI18nSlice(...a), // <- A帽adir esta l铆nea
    }))
  )
)
```

### 4.3. Inicializaci贸n en `src/App.tsx`

A帽adir l贸gica de inicializaci贸n del idioma:

```typescript
// A帽adir al useEffect de inicializaci贸n existente
useEffect(() => {
  // ... c贸digo existente de initializeProject() ...
  
  // Inicializar idioma desde localStorage
  const savedLocale = localStorage.getItem('luxsequencer:locale') as LocaleCode
  if (savedLocale && ['en', 'es'].includes(savedLocale)) {
    setLocale(savedLocale)
  }
}, [])
```

## 5. Ejemplos de Uso en Componentes

### 5.1. Hook personalizado (Recomendado)

```typescript
import { useTranslation } from '../i18n/hooks/useTranslation'

const SequencerControls: React.FC = () => {
  const { t } = useTranslation()
  const { isPlaying, togglePlayback, bpm } = useTextureStore()
  
  return (
    <div>
      <button onClick={togglePlayback}>
        {isPlaying ? t('sequencer.stop') : t('sequencer.play')}
      </button>
      <span>{t('sequencer.bpm', { value: bpm })}</span>
    </div>
  )
}
```

### 5.2. Funci贸n importada directa

```typescript
import { t } from '../i18n'

const MidiLearnButton: React.FC<{ isLearning: boolean }> = ({ isLearning }) => {
  return (
    <button>
      {isLearning ? t('midi.learning') : t('midi.learn')}
    </button>
  )
}
```

### 5.3. Con par谩metros din谩micos

```typescript
const DebugOverlay: React.FC = () => {
  const { t } = useTranslation()
  const fps = 60
  const activeAnimationsCount = 3
  
  return (
    <div>
      <div>{t('debug.fps', { value: fps })}</div>
      <div>{t('debug.animations', { count: activeAnimationsCount })}</div>
    </div>
  )
}
```

## 6. Selector de Idioma Component

### 6.1. Crear `src/components/i18n/LanguageSelector.tsx`

```typescript
import React from 'react'
import { useTranslation } from '../../i18n/hooks/useTranslation'

export const LanguageSelector: React.FC<{ className?: string }> = ({ className }) => {
  const { locale, setLocale, availableLocales } = useTranslation()

  return (
    <select 
      value={locale} 
      onChange={(e) => setLocale(e.target.value as any)}
      className={className}
    >
      <option value="en">吼 English</option>
      <option value="es"> Espa帽ol</option>
    </select>
  )
}
```

### 6.2. Integrar en Header

A帽adir el selector de idioma al header existente:

```typescript
// En src/App.tsx, dentro del header
import { LanguageSelector } from './components/i18n/LanguageSelector'

// Agregar junto a otros controles del header
<LanguageSelector className="bg-black/80 text-white rounded px-2 py-1" />
```

## 7. Migraci贸n de Strings Existentes

### 7.1. Archivos Prioritarios para Migraci贸n

**Orden de implementaci贸n sugerido:**

1. **`src/components/sequencer/Sequencer.tsx`** - Controles principales del secuenciador
2. **`src/components/controls/ControlPanel.tsx`** - Panel de controles
3. **`src/components/midi/MidiLearnButton.tsx`** - Botones MIDI
4. **`src/components/shared/SequenceManager.tsx`** - Gesti贸n de secuencias
5. **`src/App.tsx`** - Header y controles principales

### 7.2. Patr贸n de Migraci贸n

**Antes:**
```typescript
<button onClick={togglePlayback}>
  {isPlaying ? 'Stop' : 'Play'}
</button>
```

**Despu茅s:**
```typescript
import { useTranslation } from '../i18n/hooks/useTranslation'

const { t } = useTranslation()

<button onClick={togglePlayback}>
  {isPlaying ? t('sequencer.stop') : t('sequencer.play')}
</button>
```

### 7.3. Strings en Control Schemas

Para los schemas de controles (e.g., `scale-texture-schema.ts`), usar la funci贸n `t` directa:

**Antes:**
```typescript
{ type: 'slider', id: 'scaleSize', label: 'Scale Size', min: 1, max: 200 }
```

**Despu茅s:**
```typescript
import { t } from '../../i18n'

{ type: 'slider', id: 'scaleSize', label: t('controls.scaleSize'), min: 1, max: 200 }
```

## 8. Testing y Validaci贸n

### 8.1. Test de Cambio de Idioma

1. Implementar selector de idioma en el header
2. Verificar que todos los textos cambien instant谩neamente
3. Verificar persistencia en localStorage al recargar

### 8.2. Test de Performance

1. Verificar que no hay impacto en FPS durante uso intensivo
2. Medir tiempo de lookup de traducciones (deber铆a ser < 1ms)

### 8.3. Test de Fallback

1. Eliminar temporalmente una traducci贸n en espa帽ol
2. Verificar que muestra la key como fallback

## 9. Checklist de Implementaci贸n

### Configuraci贸n Base
- [ ] Instalar `rosetta`
- [ ] Crear estructura de carpetas `src/i18n/`
- [ ] Implementar `translations.ts` con todos los strings
- [ ] Crear `index.ts` con configuraci贸n de rosetta
- [ ] Implementar `useTranslation` hook
- [ ] Crear slice de i18n para Zustand

### Integraci贸n
- [ ] Agregar slice al store principal
- [ ] Inicializar idioma en `App.tsx`
- [ ] Crear componente `LanguageSelector`
- [ ] A帽adir selector al header

### Migraci贸n
- [ ] Migrar `Sequencer.tsx`
- [ ] Migrar `ControlPanel.tsx` y schemas
- [ ] Migrar `MidiLearnButton.tsx`
- [ ] Migrar strings del header
- [ ] Migrar mensajes de error

### Testing
- [ ] Test de cambio de idioma en vivo
- [ ] Test de persistencia
- [ ] Test de fallbacks
- [ ] Verificar performance en tiempo real

## 10. Notas de Performance

- **Lookups instant谩neos**: rosetta usa Maps internos para O(1) lookup
- **Sin re-renders**: Cambio de idioma no causa re-renders innecesarios
- **Memoria**: ~2KB para todas las traducciones en memoria
- **Carga inicial**: +0.1s m谩ximo en el load inicial de la app

## 11. Extensiones Futuras

### Posibles mejoras a implementar despu茅s:

1. **Formateo de n煤meros**: Para BPM, steps, etc.
```typescript
'sequencer.bpm': 'BPM: {{value, number}}'
```

2. **Pluralizaci贸n**: Para contadores
```typescript
'sequencer.patterns': '{{count}} pattern{{count, plural, s}}'
```

3. **M谩s idiomas**: Franc茅s, alem谩n, etc.

4. **Interpolaci贸n avanzada**: Para textos m谩s complejos

## 12. Troubleshooting

### Problemas Comunes

1. **Keys no encontradas**: Verificar que la key existe en `TranslationKeys`
2. **Par谩metros no funcionan**: Verificar sintaxis `{{param}}`
3. **Cambio de idioma no se ve**: Verificar que el componente usa el hook
4. **Performance issues**: rosetta no deber铆a causar problemas, revisar otros factores

### Debug

```typescript
// En consola del navegador
console.log(getCurrentLocale()) // Idioma actual
console.log(t('sequencer.play')) // Test de traducci贸n
```